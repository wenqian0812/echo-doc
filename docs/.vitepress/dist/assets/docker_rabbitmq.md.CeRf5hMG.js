import{_ as s,c as a,o as i,a2 as n}from"./chunks/framework.mlmjWbz3.js";const b=JSON.parse('{"title":"rabbitmq以及tsl 集锦","description":"","frontmatter":{},"headers":[],"relativePath":"docker/rabbitmq.md","filePath":"docker/rabbitmq.md"}'),e={name:"docker/rabbitmq.md"},t=n(`<h1 id="rabbitmq以及tsl-集锦" tabindex="-1">rabbitmq以及tsl 集锦 <a class="header-anchor" href="#rabbitmq以及tsl-集锦" aria-label="Permalink to &quot;rabbitmq以及tsl 集锦&quot;">​</a></h1><h2 id="docker部署" tabindex="-1">docker部署 <a class="header-anchor" href="#docker部署" aria-label="Permalink to &quot;docker部署&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>docker run --restart=always -itd --name rabbitmq-prod -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=qMfyBOgmDPkX2d2bw7QkmF6Gxfs0CUnX -p 15672:15672 -p 5672:5672 rabbitmq:management</span></span></code></pre></div><h2 id="权限控制" tabindex="-1">权限控制 <a class="header-anchor" href="#权限控制" aria-label="Permalink to &quot;权限控制&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>rabbitmqctl [--node &lt;node&gt;] [--longnames] [--quiet] set_permissions [--vhost &lt;vhost&gt;] &lt;username&gt; &lt;conf&gt; &lt;write&gt; &lt;read&gt;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>conf 主要匹配exchange  write（exchange queue） read（exchange queue）</span></span>
<span class="line"><span></span></span>
<span class="line"><span>rabbitmqctl set_permissions -p /test zs &#39;^echo$&#39; &#39;^(echo|ttt)$&#39; &#39;^(echo|ttt)$&#39;</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run -dit --name rabbitmq -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">U8k8L10OiaNOEX6yaMSUjwfvzVXNhPm -p </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15672</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:15672 -p </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5672</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:5672 rabbitmq:management</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run -dit --name rabbitmq-tsl -p </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">15672</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:15672 -p </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5672</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:5672 rabbitmq:management</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run --restart=always -itd  --name rabbit-tsl -e RABBITMQ_DEFAULT_USER=admin -e RABBITMQ_DEFAULT_PASS=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">123456</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> -v /home/ubuntu/rabbitmq/rabbitmq.conf:/etc/rabbitmq/rabbitmq.conf -v /home/ubuntu/rabbitmq/keys:/etc/rabbitmq/keys -p </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">18672</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:15672 -p </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">8672</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:5672 rabbitmq:management</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">docker</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run --restart=unless-stopped -d  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        -p</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8672</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:5672 -p </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">18672</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:15672 -p </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">5671</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">:5671  </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  /home/ubuntu/rabbitmq-prod/rabbitmq/:/etc/rabbitmq/   </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> rabbitmq </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\\</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        rabbitmq:management</span></span></code></pre></div><h2 id="注意" tabindex="-1">注意 <a class="header-anchor" href="#注意" aria-label="Permalink to &quot;注意&quot;">​</a></h2><p>当tsl配置密码的时候 rabbitmq中也需要配置密码</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/tls-gen/basic/result/ca_certificate.pem .</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/tls-gen/basic/result/server_certificate.pem .</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/tls-gen/basic/result/server_key.pem .</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/tls-gen/basic/result/ca_certificate.pem .</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/tls-gen/basic/result/client_certificate.pem .</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cp</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /root/tls-gen/basic/result/client_key.pem .</span></span></code></pre></div><blockquote><p><a href="https://github.com/Nepitwin/RabbitSSL" target="_blank" rel="noreferrer">参考连接 Github</a></p></blockquote><h2 id="配置文件-rabbitmq-conf" tabindex="-1">配置文件 <code>rabbitmq.conf</code> <a class="header-anchor" href="#配置文件-rabbitmq-conf" aria-label="Permalink to &quot;配置文件 \`rabbitmq.conf\`&quot;">​</a></h2><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>default_user  = admin</span></span>
<span class="line"><span>default_pass  = admin</span></span>
<span class="line"><span>#default_vhost = /</span></span>
<span class="line"><span></span></span>
<span class="line"><span>listeners.tcp = none</span></span>
<span class="line"><span>listeners.ssl.default = 5671</span></span>
<span class="line"><span></span></span>
<span class="line"><span>ssl_options.cacertfile           = /etc/ssl/rabbit/ca_certificate.pem</span></span>
<span class="line"><span>ssl_options.certfile             = /etc/ssl/rabbit/server_certificate.pem</span></span>
<span class="line"><span>ssl_options.keyfile              = /etc/ssl/rabbit/server_key.pem</span></span>
<span class="line"><span>ssl_options.verify               = verify_peer</span></span>
<span class="line"><span>ssl_options.password             = 123456</span></span>
<span class="line"><span>ssl_options.fail_if_no_peer_cert = true</span></span></code></pre></div>`,12),p=[t];function l(h,r,k,c,d,o){return i(),a("div",null,p)}const g=s(e,[["render",l]]);export{b as __pageData,g as default};
